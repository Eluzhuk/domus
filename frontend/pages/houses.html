<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Дома</title>
	<!-- Tabler CSS -->
	<link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta20/dist/css/tabler.min.css" rel="stylesheet"/>
	<!-- Иконки -->
	<link href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@2.47.0/tabler-icons.min.css" rel="stylesheet"/>
	<!-- Персонализация проекта -->
	<link rel="stylesheet" href="../assets/styles.css" />
</head>
<body>
	<main class="content" id="main" tabindex="-1">
		<!-- Tabler Modal: Создать дом -->
		<div class="modal modal-blur fade" id="houseModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
			<div class="modal-content">
				<form id="houseForm">
				<div class="modal-header">
					<h5 class="modal-title">Создание нового дома</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
				</div>
				<div class="modal-body">
					<div class="row g-2">
						<div class="col-12">
						<label class="form-label" for="houseName">Название</label>
						<input type="text" class="form-control" id="houseName" required autocomplete="organization" />
						</div>
						<div class="col-12">
						<label class="form-label" for="houseAddress">Адрес</label>
						<input type="text" class="form-control" id="houseAddress" required autocomplete="street-address" />
						</div>
						<div class="col-12">
						<label class="form-label" for="houseSlug">Slug</label>
						<input type="text" class="form-control" id="houseSlug" required autocomplete="slug" placeholder="например, dom-1-na-pushkina" />
						<button type="button" id="generateSlug" class="btn btn-outline-primary btn-sm mt-2" title="Сгенерировать из названия">Сгенерировать</button>
						</div>
						<div>
						<small class="form-hint">Slug нужен для публичной ссылки: /pages/board.html?slug=&lt;slug&gt;. Разрешены только латиница, цифры и дефисы.</small>
						</div>
						<div class="hr-text">Структура дома</div>
						<div class="col-12">
						<label class="form-check mb-1">
							<input class="form-check-input" type="checkbox" id="nonResidential"/>
							<span class="form-check-label">Нежилой первый этаж</span>
						</label>
						</div>

						<div class="col-12">
						<h3 class="mb-2">Подъезды</h3>
						<div id="entrancesContainer" class="vstack gap-2"></div>
						<button type="button" id="addEntrance" class="btn btn-outline-primary btn-sm mt-2">
							<i class="ti ti-plus me-1"></i>Добавить подъезд
						</button>
						</div>

						<div class="col-12">
						<h3 class="mb-2">Паркинг</h3>
						<label class="form-check mb-2">
							<input class="form-check-input" type="checkbox" id="addParking"/>
							<span class="form-check-label">Добавить паркинг</span>
						</label>
						<div id="parkingContainer" class="vstack gap-2" style="display:none;">
							<button type="button" id="addParkingLevel" class="btn btn-outline-primary btn-sm">
								<i class="ti ti-plus me-1"></i>Добавить уровень паркинга
							</button>
						</div>
						</div>

						<div class="col-12">
						<h3 class="mb-2">Кладовые</h3>
						<label class="form-check mb-2">
							<input class="form-check-input" type="checkbox" id="addStorage"/>
							<span class="form-check-label">Добавить кладовые</span>
						</label>
						<div id="storageContainer" class="vstack gap-2" style="display:none;">
							<button type="button" id="addStorageLevel" class="btn btn-outline-primary btn-sm">
								<i class="ti ti-plus me-1"></i>Добавить уровень кладовых
							</button>
						</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-link" data-bs-dismiss="modal">Отмена</button>
					<button type="submit" class="btn btn-primary">Создать</button>
				</div>
				</form>
			</div>
		</div>
		</div>

		<!-- Tabler: шапка страницы с поиском и кнопкой -->
		<div class="page-header d-print-none">
		<div class="container-xl">
			<div class="row g-2 align-items-center">
				<div class="col">
				<h2 class="page-title">Дома</h2>
				</div>
				<div class="col-auto ms-auto d-print-none">
				<div class="d-flex">
					<input type="search" class="form-control me-2" id="searchHouse" placeholder="Поиск по адресу или ID…">
					<a href="#" class="btn btn-primary" id="openModal">
						<i class="ti ti-plus me-1"></i> Добавить дом
					</a>
				</div>
				</div>
			</div>
		</div>
		</div>

		<!-- Tabler: тело страницы с сеткой карточек -->
		<div class="page-body">
		<div class="container-xl">
			<div id="housesContainer" class="row row-cards"></div>
		</div>
		</div>

		<!-- Tabler Modal: Редактировать дом -->
		<div class="modal modal-blur fade" id="editModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">
				<form id="editForm">
				<div class="modal-header">
					<h5 class="modal-title">Редактировать дом</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
				</div>
				<div class="modal-body">
					<div class="mb-2">
						<label class="form-label" for="editName">Название дома</label>
						<input type="text" id="editName" class="form-control" required autocomplete="organization" />
					</div>
					<div class="mb-2">
						<label class="form-label" for="editAddress">Адрес дома</label>
						<input type="text" id="editAddress" class="form-control" required autocomplete="street-address" />
					</div>
					<div class="mb-2">
						<label class="form-label" for="editSlug">Slug</label>
						<input type="text" id="editSlug" class="form-control" required autocomplete="street-address" placeholder="например, dom-1-na-pushkina"/>
						<small class="form-hint">Если оставить пустым, сервер сгенерирует на основе названия (и обеспечит уникальность).</small>
					</div>
					
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-link" data-bs-dismiss="modal">Отмена</button>
					<button type="submit" class="btn btn-primary">Сохранить</button>
				</div>
				</form>
			</div>
		</div>
		</div>
	</main>

	<!-- Tabler Modal: Добавить жильца -->
	<div class="modal modal-blur fade" id="addResidentModal" tabindex="-1" aria-hidden="true">
	<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
		<div class="modal-content">
			<form id="addResidentForm">
			<div class="modal-header">
				<h5 class="modal-title" id="addResidentTitle">Добавить жильца</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
			</div>
			<div class="modal-body">
				<div class="row g-2">
					<!-- ФИО-->
					<div class="col-12">
					<div class="d-flex justify-content-between align-items-center">
						<label class="form-label m-0" for="residentFullName">ФИО</label>
						<button type="button"
									class="btn btn-ghost-secondary btn-icon privacy-toggle"
									data-target="name" aria-pressed="true"
									title="Показывать ФИО в шахматке" aria-label="Показывать ФИО">
							<i class="ti ti-eye"></i>
						</button>
					</div>
					<input type="text" id="residentFullName" name="full_name" class="form-control" required autocomplete="name" />
					</div>

					<!-- Телеграм -->
					<div class="col-sm-6">
					<div class="d-flex justify-content-between align-items-center">
						<label class="form-label m-0" for="residentTelegram">Телеграм</label>
						<button type="button"
									class="btn btn-ghost-secondary btn-icon privacy-toggle"
									data-target="telegram" aria-pressed="true"
									title="Показывать Telegram в шахматке" aria-label="Показывать Telegram">
							<i class="ti ti-eye"></i>
						</button>
					</div>
					<input type="text" id="residentTelegram" name="telegram" class="form-control" autocomplete="off" />
					</div>

					<!-- Телефон -->
					<div class="col-sm-6">
					<div class="d-flex justify-content-between align-items-center">
						<label class="form-label m-0" for="residentPhone">Телефон</label>
						<button type="button"
									class="btn btn-ghost-secondary btn-icon privacy-toggle"
									data-target="phone" aria-pressed="true"
									title="Показывать телефон в шахматке" aria-label="Показывать телефон">
							<i class="ti ti-eye"></i>
						</button>
					</div>
					<input type="text" id="residentPhone" name="phone" class="form-control" autocomplete="tel" inputmode="tel" />
					</div>

					<!-- Email -->
					<div class="col-12">
					<div class="d-flex justify-content-between align-items-center">
						<label class="form-label m-0" for="residentEmail">Email</label>
						<button type="button"
									class="btn btn-ghost-secondary btn-icon privacy-toggle"
									data-target="email" aria-pressed="true"
									title="Показывать email в шахматке" aria-label="Показывать email">
							<i class="ti ti-eye"></i>
						</button>
					</div>
					<input type="email" id="residentEmail" name="email" class="form-control" autocomplete="email" />
					</div>

					<!-- Квартиры -->
					<div class="col-12" id="apartmentContainer">
					<label class="form-label">Квартиры</label>
					<div class="d-flex gap-2 align-items-center apartment-input mb-2">
						<input type="text" class="form-control" name="apartments[]" placeholder="Номер квартиры" inputmode="numeric" />
						<label class="form-check m-0">
							<input class="form-check-input" type="checkbox" name="tenant[]" />
							<span class="form-check-label">Арендатор</span>
						</label>
					</div>
					<button type="button" id="addApartmentField" class="btn btn-outline-primary btn-sm">
						<i class="ti ti-plus me-1"></i>Добавить квартиру
					</button>
					</div>

					<!-- Парковка -->
					<div class="col-12" id="parkingContainer">
					<label class="form-label">Парковочные места</label>
					<div class="d-flex gap-2 align-items-center parking-input mb-2">
						<input type="text" class="form-control" name="parking[]" placeholder="Номер парковки" inputmode="numeric" />
						<label class="form-check m-0">
							<input class="form-check-input" type="checkbox" name="parkingTenant[]" />
							<span class="form-check-label">Арендатор</span>
						</label>
					</div>
					<button type="button" id="addParkingField" class="btn btn-outline-primary btn-sm">
						<i class="ti ti-plus me-1"></i>Добавить парковку
					</button>
					</div>

					<!-- Кладовые -->
					<div class="col-12" id="storageContainer">
					<label class="form-label">Кладовые</label>
					<div class="d-flex gap-2 align-items-center storage-input mb-2">
						<input type="text" class="form-control" name="storages[]" placeholder="Номер кладовой" inputmode="numeric" />
						<label class="form-check m-0">
							<input class="form-check-input" type="checkbox" name="storageTenant[]" />
							<span class="form-check-label">Арендатор</span>
						</label>
					</div>
					<button type="button" id="addStorageField" class="btn btn-outline-primary btn-sm">
						<i class="ti ti-plus me-1"></i>Добавить кладовую
					</button>
					</div>
				</div>
			</div>

			<div class="modal-footer">
				<button type="button" class="btn btn-link" data-bs-dismiss="modal">Отмена</button>
				<button type="submit" class="btn btn-primary">Сохранить</button>
			</div>
			</form>
		</div>
	</div>
	</div>

<script src="../scripts/config.js"></script>
<script src="../scripts/ui.js"></script>
<script src="../scripts/auth-guard.js"></script>
<script src="../scripts/layout.js"></script>
<script src="../scripts/houses.js" defer></script>
<!-- Tabler JS -->
<script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.0.0-beta20/dist/js/tabler.min.js" defer></script>
</body>
</html>
